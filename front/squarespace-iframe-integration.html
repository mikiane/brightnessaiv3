<!-- 
=================================================================
  CODE Ã€ COPIER DANS SQUARESPACE (Bloc Code)
  Auto-resize iframe pour Brightness AI Chat
=================================================================
-->

<!-- L'iframe qui contient le chat -->
<iframe
  id="ba-avatar"
  src="https://dev.brightness-agency.com/avatar/?index=bi_adaptability3"
  style="
    width: 100%;
    max-width: 900px;
    height: 600px;
    border: 0;
    border-radius: 12px;
    box-shadow: 0 6px 24px rgba(0,0,0,.15);
    transition: height 0.3s ease;
    display: block;
    margin: 0 auto;
  "
  loading="lazy"
  allow="clipboard-write"
></iframe>

<!-- Script d'auto-redimensionnement -->
<script>
(function(){
  'use strict';
  
  console.log('ðŸŸ¢ Brightness iframe auto-resize activÃ©');
  
  const iframe = document.getElementById('ba-avatar');
  
  if (!iframe) {
    console.error('âŒ Iframe #ba-avatar non trouvÃ©e');
    return;
  }
  
  // Ã‰couter les messages de l'iframe
  window.addEventListener('message', function(event) {
    // VÃ©rifier l'origine pour la sÃ©curitÃ© (optionnel en dev)
    if (event.origin !== 'https://dev.brightness-agency.com') {
      console.log('âš ï¸ Message reÃ§u d\'une origine non autorisÃ©e:', event.origin);
      return;
    }
    
    // VÃ©rifier que c'est un message de resize
    if (event.data && event.data.type === 'brightnessResize') {
      const newHeight = event.data.height;
      
      // Appliquer la nouvelle hauteur
      iframe.style.height = newHeight + 'px';
      
      console.log('âœ… Iframe redimensionnÃ©e:', newHeight + 'px');
      
      // Optionnel : scroller vers le bas de l'iframe si nÃ©cessaire
      // pour garder la zone de saisie visible
      const iframeRect = iframe.getBoundingClientRect();
      const windowHeight = window.innerHeight;
      
      // Si le bas de l'iframe est hors de vue, scroller doucement
      if (iframeRect.bottom > windowHeight) {
        window.scrollTo({
          top: window.scrollY + (iframeRect.bottom - windowHeight) + 50,
          behavior: 'smooth'
        });
      }
    }
  });
  
  console.log('ðŸ‘‚ Ã‰coute des messages postMessage activÃ©e');
})();
</script>

<!-- 
=================================================================
  NOTES D'UTILISATION
=================================================================

1. Copiez tout ce code dans un bloc "Code" de Squarespace
2. Le chat se redimensionnera automatiquement Ã  chaque nouveau message
3. La hauteur initiale est de 600px, puis s'adapte au contenu
4. Le scroll se fait automatiquement pour garder la zone de saisie visible

Pour changer l'index du chat, modifiez : ?index=bi_adaptability3

=================================================================
-->

